/*! layer弹层组件拓展类 */
;!function(){layer.use("skin/layer.ext.css",function(){layer.layui_layer_extendlayerextjs=!0});var d=layer.cache||{},c=function(a){return d.skin?" "+d.skin+" "+d.skin+"-"+a:""};layer.prompt=function(b,h){b=b||{},"function"==typeof b&&(h=b);var g,f=2==b.formType?'<textarea class="layui-layer-input">'+(b.value||"")+"</textarea>":function(){return'<input type="'+(1==b.formType?"password":"text")+'" class="layui-layer-input" value="'+(b.value||"")+'">'}();return layer.open($.extend({btn:["&#x786E;&#x5B9A;","&#x53D6;&#x6D88;"],content:f,skin:"layui-layer-prompt"+c("prompt"),success:function(e){g=e.find(".layui-layer-input"),g.focus()},yes:function(a){var i=g.val();""===i?g.focus():i.length>(b.maxlength||500)?layer.tips("&#x6700;&#x591A;&#x8F93;&#x5165;"+(b.maxlength||500)+"&#x4E2A;&#x5B57;&#x6570;",g,{tips:1}):h&&h(i,a,g)}},b))},layer.tab=function(b){b=b||{};var e=b.tab||{};return layer.open($.extend({type:1,skin:"layui-layer-tab"+c("tab"),title:function(){var g=e.length,f=1,h="";if(g>0){for(h='<span class="layui-layer-tabnow">'+e[0].title+"</span>";g>f;f++){h+="<span>"+e[f].title+"</span>"}}return h}(),content:'<ul class="layui-layer-tabmain">'+function(){var g=e.length,f=1,h="";if(g>0){for(h='<li class="layui-layer-tabli xubox_tab_layer">'+(e[0].content||"no content")+"</li>";g>f;f++){h+='<li class="layui-layer-tabli">'+(e[f].content||"no  content")+"</li>"}}return h}()+"</ul>",success:function(g){var f=g.find(".layui-layer-title").children(),h=g.find(".layui-layer-tabmain").children();f.on("mousedown",function(j){j.stopPropagation?j.stopPropagation():j.cancelBubble=!0;var i=$(this),k=i.index();i.addClass("layui-layer-tabnow").siblings().removeClass("layui-layer-tabnow"),h.eq(k).show().siblings().hide()})}},b))},layer.photos=function(v,u,t){function s(f,e,h){var g=new Image;g.onload=function(){g.onload=null,e(g)},g.onerror=function(i){g.onerror=null,h(i)},g.src=f}var r={};if(v=v||{},v.photos){var q=v.photos.constructor===Object,p=q?v.photos:{},o=p.data||[],n=p.start||0;if(r.imgIndex=n+1,q){if(0===o.length){return void layer.msg("&#x6CA1;&#x6709;&#x56FE;&#x7247;")}}else{var m=$(v.photos),b=m.find(v.img||"img");if(0===b.length){return}if(u||m.find(p.img||"img").each(function(a){var e=$(this);o.push({alt:e.attr("alt"),pid:e.attr("layer-pid"),src:e.attr("layer-src")||e.attr("src"),thumb:e.attr("src")}),e.on("click",function(){layer.photos($.extend(v,{photos:{start:a,data:o,tab:v.tab},full:v.full}),!0)})}),!u){return}}r.imgprev=function(e){r.imgIndex--,r.imgIndex<1&&(r.imgIndex=o.length),r.tabimg(e)},r.imgnext=function(f,e){r.imgIndex++,r.imgIndex>o.length&&(r.imgIndex=1,e)||r.tabimg(f)},r.keyup=function(f){if(!r.end){var e=f.keyCode;f.preventDefault(),37===e?r.imgprev(!0):39===e?r.imgnext(!0):27===e&&layer.close(r.index)}},r.tabimg=function(a){o.length<=1||(p.start=r.imgIndex-1,layer.close(r.index),layer.photos(v,!0,a))},r.event=function(){r.bigimg.hover(function(){r.imgsee.show()},function(){r.imgsee.hide()}),r.bigimg.find(".layui-layer-imgprev").on("click",function(e){e.preventDefault(),r.imgprev()}),r.bigimg.find(".layui-layer-imgnext").on("click",function(e){e.preventDefault(),r.imgnext()}),$(document).on("keyup",r.keyup)},r.loadi=layer.load(1,{shade:"shade" in v?!1:0.9,scrollbar:!1}),s(o[n].src,function(a){layer.close(r.loadi),r.index=layer.open($.extend({type:1,area:function(){var e=[a.width,a.height],f=[$(window).width()-100,$(window).height()-100];return !v.full&&e[0]>f[0]&&(e[0]=f[0],e[1]=e[0]*f[1]/e[0]),[e[0]+"px",e[1]+"px"]}(),title:!1,shade:0.9,shadeClose:!0,closeBtn:!1,move:".layui-layer-phimg img",moveType:1,scrollbar:!1,moveOut:!0,shift:5*Math.random()|0,skin:"layui-layer-photos"+c("photos"),content:'<div class="layui-layer-phimg"><img src="'+o[n].src+'" alt="'+(o[n].alt||"")+'" layer-pid="'+o[n].pid+'"><div class="layui-layer-imgsee">'+(o.length>1?'<span class="layui-layer-imguide"><a href="javascript:;" class="layui-layer-iconext layui-layer-imgprev"></a><a href="javascript:;" class="layui-layer-iconext layui-layer-imgnext"></a></span>':"")+'<div class="layui-layer-imgbar" style="display:'+(t?"block":"")+'"><span class="layui-layer-imgtit"><a href="javascript:;">'+(o[n].alt||"")+"</a><em>"+r.imgIndex+"/"+o.length+"</em></span></div></div></div>",success:function(e,f){r.bigimg=e.find(".layui-layer-phimg"),r.imgsee=e.find(".layui-layer-imguide,.layui-layer-imgbar"),r.event(e),v.tab&&v.tab(o[n],e)},end:function(){r.end=!0,$(document).off("keyup",r.keyup)}},v))},function(){layer.close(r.loadi),layer.msg("&#x5F53;&#x524D;&#x56FE;&#x7247;&#x5730;&#x5740;&#x5F02;&#x5E38;<br>&#x662F;&#x5426;&#x7EE7;&#x7EED;&#x67E5;&#x770B;&#x4E0B;&#x4E00;&#x5F20;&#xFF1F;",{time:30000,btn:["下一张","不看了"],yes:function(){o.length>1&&r.imgnext(!0,!0)}})})}}}();