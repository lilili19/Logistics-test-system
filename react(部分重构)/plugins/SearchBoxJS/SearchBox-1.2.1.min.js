function SearchBox(){this.TabData="";this.myMethod=null;this.rsCount=0;this.PageSize=7;this.PageIndex=1;this.PageLength=5;this.IsPageTotal=0;this.url="";this.pageStr="";this.method="";this.methodName="";this.key="";this.data="";this.setObj=null;this.setObj1=null;this.defKey="";this.defKey1="";this.defVal="";this.valName="";this.valName1="";this.cols="";this.loca=null;this.ItemTabs=new Object();this.KeyVals=new Array("","","","");this.first=1;this.layerIndex=0;this.IsShow=0;this.BoxSearch=function(){this.PageIndex=1;this.key=null;this.gogo()};this.go=function(f,e,d,b,c,a){this.go2(f,e,d,"","",b,c,a)};this.go2=function(a,b,h,i,j,g,f,c){if(b==""){return}var e=null,d=null;if(typeof(b)=="object"){e=$(b)}else{e=$("#"+b)}if(i!=""){d=$("#"+i)}if(g!=undefined&&g==""){return}this.key=null;if(g!=undefined&&g!=null){this.key=g}this.data="";if(f!=undefined){this.data=f}this.myMethod=null;if(c!=undefined){this.myMethod=c}this.setObj=e;this.setObj1=d;this.valName=h;this.valName1=j;this.method=a;this.loca=e;this.cols="";this.PageIndex=1;this.IsShow=0;SearchBox.my=this;this.gogo()};this.gogo=function(){SearchBox.my=this;var c="",b="";var a="PageSize="+this.PageSize+"&PageIndex="+this.PageIndex+"&first="+this.first;if(this.url!=null){b=this.url;a+="&"+this.methodName+"="+this.method}else{b="/Search/"+this.method}if(this.key){a+="&"+this.data+"key="+this.key}if(this.key!=null){if(this.setObj!=null){$(this.setObj).val("")}if(this.setObj1!=null){$(this.setObj1).val("")}}$.ajax({type:"post",url:b,data:a,dataType:"json",error:function(d){SearchBox.my.key=null;alert("Error loading "+d)},success:function(d){SearchBox.my.first=0;d=d.oper;SearchBox.my.show(d)}})};this.show=function(f){if(f==undefined||f=="null"||f.rows==undefined||f.rows==""){layer.open({type:1,shift:2,skin:"layui-layer-demo",shadeClose:true,scrollbar:false,title:"选择",area:["800px","400px"],content:"无此相关数据"});if(SearchBox.my.key!=null){$("#txtSearchKey").val(SearchBox.my.key)}SearchBox.my.key=null;return}var d=0;f.rows[0].rsCount=f.rows.length;SearchBox.my.TabData=f;if(f!=undefined&&f!=null&&f.rows[0].rsCount!=undefined){d=f.rows[0].rsCount-0}SearchBox.my.rsCount=d;SearchBox.my.first=0;if(d==1&&SearchBox.my.key!=null){SearchBox.showData(0);SearchBox.my.key=null;return}var a=$("#tabSearchBox");if(a!=undefined||a!=""){a.find("tr").each(function(k){if(k>0){$(this).remove()}})}if(SearchBox.my.IsShow==0){var j="";j+='<div id="divSearch" style=""> <div style="margin-left:10px;margin-right:10px;margin-top:10px;"> ';j+='  <div class="top10 bottom10" id="divKey">&nbsp;&nbsp;<select id="selKey1" onchange="SearchBox.my.PageChange(1)" style="display:none"><option value=""></option></select>&nbsp;&nbsp;<select id="selKey2" onchange="SearchBox.my.PageChange(1)" style="display:none"><option value=""></option></select>&nbsp;&nbsp;<select id="selKey3" onchange="SearchBox.my.PageChange(1)" style="display:none"><option value=""></option></select>&nbsp;&nbsp;关键字&nbsp;<input id="txtSearchKey" type="text" onchange="SearchBox.my.PageChange(1)">&nbsp;&nbsp;<input type="button" id="btnKeySearch" value="查找" class="button" onclick="SearchBox.my.PageChange(1)"></div>';j+='    <table id="tabSearchBox"  class="table table-border table-bordered table-bg table-hover table-sort"  data-side-pagination="server" data-pagination="true" data-search="true" >';j+="    <tbody><tr><td></td></tr></tbody> </table> ";j+='<div id="divSearchPage"> </div></div> </div>';SearchBox.my.layerIndex=layer.open({type:1,shift:2,shadeClose:true,scrollbar:true,title:"选择",area:["800px","456px"],yes:function(k){SearchBox.my.layerIndex=index;alert(k)},content:j});SearchBox.my.IsShow=1}var b=SearchBox.my.method;if(b=="users"){SearchBox.my.cols="c1,用户ID,70|c2,姓名,100"}else{if(b=="oper"){SearchBox.my.cols="name,岗位名称,80|machInte,设备接口,200"}else{if(b=="storeHouse"){SearchBox.my.cols="c1,编号,80|c2,库区,200"}else{if(b=="operPost"){SearchBox.my.cols="c1,编号,80|c2,岗位,200"}else{if(b=="profili"){SearchBox.my.cols="c1,型材编码,80|c2,型材描述,200"}else{if(b=="accessori"){SearchBox.my.cols="c1,玻璃编码,80|c2,玻璃描述,200"}else{if(b=="vetri"){SearchBox.my.cols="c1,配件编码,80|c2,配件描述,200"}else{if(b=="trattamenti"){SearchBox.my.cols="c2,处理描述,200"}else{if(b=="colori"){SearchBox.my.cols="c1,颜色编码,80|c2,颜色描述,200"}}}}}}}}}$("#divKey").show();$("#BoxPage").show();if(SearchBox.my.key!=undefined&&SearchBox.my.key!=null){$("#txtSearchKey").val(SearchBox.my.key)}SearchBox.my.key=null;var e="";var c;var i=SearchBox.my.cols.split("|");for(var h in i){c=i[h].split(",");if(c[1]!=""){e+='<th style="width:'+c[2]+'px">'+c[1]+"</th>"}}var g=$("#tabSearchBox tr:first");if(g!=undefined){$(g).html(e)}SearchBox.showTab(f);SearchBox.my.ShowPage()};this.AddSelItems=function(d,g,a,f){var b="",e="";if(f!=undefined){b=f}var c=0;$(d).empty();if(g!="0"){$(d).append("<option value=''>"+g+"</option>");c++}$(a).each(function(h){if(this.t=="default"){if(b==""){b=this.v}}else{if(h==0){e=this.v}$(d).append("<option value='"+this.v+"'>"+this.t+"</option>");c++}});if(b==""&&g=="0"){b=e}$(d).val(b);if(c>1){$(d).show()}else{$(d).hide()}};this.ShowPage=function(){var b=$("#divSearchPage");if(b==undefined){return}if(SearchBox.my.rsCount<=0){$(b).html("null");return}var g="";if(SearchBox.my.rsCount>SearchBox.my.PageSize){g='<div class="pagination" style="letter-spacing: 10px;">';var e=1;if(SearchBox.my.rsCount>SearchBox.my.PageSize){e=parseInt(SearchBox.my.rsCount/SearchBox.my.PageSize)}if(SearchBox.my.rsCount%SearchBox.my.PageSize){e++}var h=1;if(SearchBox.my.PageIndex>SearchBox.my.PageLength){h=SearchBox.my.PageIndex-SearchBox.my.PageIndex%SearchBox.my.PageLength+1}var d=h+SearchBox.my.PageLength;if(d>e){d=e}var c=SearchBox.my.PageIndex-1;var a=SearchBox.my.PageIndex+1;if(c<=0){c=1}if(a>=e){a=e}if(SearchBox.my.IsPageTotal==1){g+='<span class="f_left">记录总数:'+SearchBox.my.rsCount+" 总页数:"+e+" 每页:"+SearchBox.my.PageSize+" 当前页:"+SearchBox.my.PageIndex+"</span> "}else{g+='<span class="f_left">记录总数:'+SearchBox.my.rsCount+"</span> "}g+='<a href="javascript:void(0);" class="number"  onclick="SearchBox.my.PageChange(1)">首页</a><a href="javascript:void(0);" class="number"  onclick="SearchBox.my.PageChange('+c+')" title="Previous Page">&laquo; </a>';for(var f=h;f<=d;f++){if(f==SearchBox.my.PageIndex){g+='<a href="javascript:void(0);" class="number current">'+f+"</a>"}else{g+='<a href="javascript:void(0);" class="number" onclick="SearchBox.my.PageChange('+f+')">'+f+"</a>"}}if(e!=a){g+='<a href="javascript:void(0);" class="number" title="Next Page" onclick="SearchBox.my.PageChange('+a+')">...</a>'}g+='<a href="javascript:void(0);" class="number" title="Next Page" onclick="SearchBox.my.PageChange('+a+')"> &raquo;</a><a href="javascript:void(0);" class="number"  title="Last Page" onclick="SearchBox.my.PageChange('+e+')">尾页</a>';g+="</div>"}else{g+='<div class="pagination"><span class="f_left">记录总数:'+SearchBox.my.rsCount+"</span></div>"}$(b).html(g)};this.PageChange=function(a){SearchBox.my.PageIndex=a;SearchBox.my.gogo()}}SearchBox.my=null;SearchBox.chooseImg="/images/Choose.gif";SearchBox.showTab=function(b){var a;var f=SearchBox.my.cols.split("|");var e=$("#tabSearchBox");e.find("tr").each(function(g){if(g>0){$(this).remove()}});var c="",d="";$(b.rows).each(function(i,h){d="";for(var g in f){a=f[g].split(",");c=a[0];d+='<td style="text-align:center;width:'+a[2]+'px"><a onclick="SearchBox.showData('+i+')">'+h[c]+"</a></td>"}if(d!=""){d="<tr>"+d+"</tr>";e.append(d)}})};SearchBox.showData=function(b){var a=SearchBox.my.TabData.rows[b];if(SearchBox.my.myMethod!=undefined&&SearchBox.my.myMethod!=null){SearchBox.my.myMethod(a)}else{if(SearchBox.my.setObj!=undefined&&SearchBox.my.setObj!=null&&SearchBox.my.valName!=""){$(SearchBox.my.setObj).val(a[SearchBox.my.valName])}if(SearchBox.my.setObj1!=undefined&&SearchBox.my.setObj1!=null&&SearchBox.my.valName1!=""){$(SearchBox.my.setObj1).val(a[SearchBox.my.valName1])}}layer.close(SearchBox.my.layerIndex);SearchBox.my.IsShow=0};SearchBox.NextFocus=function(b){var a="body";if(b!=undefined&&b!=""){a="#"+b}$(a+" :input:not(:hidden),input[type='text'],input[type='button'],select").bind("keydown",function(e){var f=e.keyCode?e.keyCode:e.which;if(f==13){var d=$(a+" :input:not(:hidden),input[type='text'],input[type='button'],select");var c=d.index(this);var g=d[c+1].type;if(c<d.length-1){if(g=="button"){$(d[c+1]).click()}else{$(d[c+1]).focus()}if(g=="text"){$(d[c+1]).select()}}return false}})};